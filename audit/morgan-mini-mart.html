<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Morgan Mini Mart | Profit Protection Audit</title>
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        :root {
            --englewood-green: #2e7d32;
            --bitflow-gold: #ffb300;
            --midnight: #1a1a1a;
            --panel: #263238;
            --white: #ffffff;
            --text: #eceff1;
            --danger: #ef5350;
        }
        
        body { margin: 0; font-family: 'Segoe UI', Roboto, sans-serif; background: var(--midnight); color: var(--text); padding-bottom: 60px; }
        .header { background: linear-gradient(135deg, #000000 0%, #1b5e20 100%); padding: 30px 5%; text-align: center; border-bottom: 3px solid var(--bitflow-gold); }
        .header h1 { margin: 0; font-size: 2rem; color: var(--white); text-transform: uppercase; }
        
        .dashboard { max-width: 1000px; margin: 20px auto; padding: 20px; display: grid; grid-template-columns: 1.2fr 1fr; gap: 20px; }
        .card { background: var(--panel); border-radius: 12px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); border: 1px solid #37474f; }
        
        h2 { margin-top: 0; color: var(--bitflow-gold); font-size: 1.2rem; border-bottom: 1px solid #455a64; padding-bottom: 10px; }
        
        .input-group { margin-bottom: 20px; }
        label { display: block; font-size: 0.8rem; color: #b0bec5; text-transform: uppercase; margin-bottom: 5px; }
        input, select { width: 100%; padding: 12px; background: #37474f; border: 1px solid #546e7a; color: white; border-radius: 6px; font-size: 1.1rem; }
        
        /* Chart Container */
        .chart-container { position: relative; margin: auto; height: 250px; width: 250px; }

        .metric-box { background: #000; padding: 15px; border-radius: 8px; text-align: center; margin-top: 15px; border: 1px solid #333; }
        .metric-val { font-size: 1.8rem; font-weight: bold; color: var(--white); }
        .metric-label { font-size: 0.75rem; color: #90a4ae; text-transform: uppercase; }
        .green { color: #69f0ae; }
        
        .btn-main { width: 100%; background: var(--bitflow-gold); color: #000; padding: 15px; font-weight: bold; border: none; border-radius: 6px; cursor: pointer; font-size: 1.1rem; margin-top: 20px; text-transform: uppercase; }

        @media (max-width: 800px) { .dashboard { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<div class="header">
    <h1>Morgan Mini Mart</h1>
    <div style="color:var(--bitflow-gold); font-weight:bold;">Sami Deffala: Food Desert Margin Protection</div>
</div>

<div class="dashboard">

    <div class="card">
        <h2>Financial Variables</h2>
        <div class="input-group">
            <label>Monthly Gross Revenue ($60k Est.)</label>
            <input type="number" id="revenue" value="60000" oninput="updateChart()">
        </div>
        
        <div class="input-group">
            <label>Non-SNAP Card Volume (%)</label>
            <input type="range" id="card_pct" min="10" max="60" value="35" oninput="updateChart()">
            <div style="text-align:right; font-weight:bold;" id="card_display">35%</div>
        </div>

        <div class="input-group">
            <label>Current Bank Fee (Effective %)</label>
            <select id="legacy_rate" onchange="updateChart()">
                <option value="0.05">5.0% (Small Tickets/Sweets)</option>
                <option value="0.07" selected>7.0% (Micro-Transactions)</option>
                <option value="0.04">4.0% (Blended)</option>
            </select>
        </div>

        <div class="metric-box">
            <div class="metric-label">Annual Wealth Extraction (Banks)</div>
            <div class="metric-val" id="annual_leak" style="color:var(--danger)">$0</div>
        </div>
    </div>

    <div class="card" style="text-align: center;">
        <h2>The Recovery Model (3.0% Initial)</h2>
        
        <div class="chart-container">
            <canvas id="profitChart"></canvas>
        </div>

        <div class="metric-box" style="border-color: var(--englewood-green);">
            <div class="metric-label">Projected Annual Recovery</div>
            <div class="metric-val green" id="recovery_val">$0</div>
            <div style="font-size:0.7rem; color:#aaa; margin-top:5px;">*Funds available for store upgrades & produce</div>
        </div>

        <button class="btn-main">Activate Infrastructure</button>
    </div>

</div>

<script>
    let myChart;

    function initChart() {
        const ctx = document.getElementById('profitChart').getContext('2d');
        myChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['Sami Keeps', 'Bank Takes', 'POSitive Savings'],
                datasets: [{
                    data: [93, 7, 0],
                    backgroundColor: ['#2e7d32', '#ef5350', '#ffb300'],
                    borderWidth: 0
                }]
            },
            options: {
                cutout: '70%',
                plugins: { legend: { display: false } }
            }
        });
    }

    function updateChart() {
        const rev = parseFloat(document.getElementById('revenue').value) || 0;
        const card_pct = parseFloat(document.getElementById('card_pct').value) / 100;
        const legacy_rate = parseFloat(document.getElementById('legacy_rate').value);
        
        document.getElementById('card_display').innerText = (card_pct * 100).toFixed(0) + "%";

        const card_vol = rev * card_pct;
        const our_rate = 0.030; // 3.0% baseline

        // Math
        const monthly_leak = card_vol * legacy_rate;
        const monthly_cost_new = card_vol * our_rate;
        const monthly_recovery = monthly_leak - monthly_cost_new;

        // Displays
        document.getElementById('annual_leak').innerText = '$' + (monthly_leak * 12).toLocaleString();
        document.getElementById('recovery_val').innerText = '$' + (monthly_recovery * 12).toLocaleString();

        // Update Chart Data
        // We show the "New State" where the Red slice is smaller and the Gold slice represents the recovery.
        const total = rev;
        const kept = rev - monthly_leak;
        const leaked = monthly_cost_new;
        const saved = monthly_recovery;

        myChart.data.datasets[0].data = [kept, leaked, saved];
        myChart.update();
    }

    initChart();
    updateChart();
</script>

</body>
</html>
