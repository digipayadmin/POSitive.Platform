<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NDPS | Chicago Fintech Infrastructure</title>
    <style>
        :root {
            --navy: #000035; --gold: #D4AF37; --white: #ffffff;
            --grey: #f8f9fa; --text: #333333; --emerald: #004d40;
            --glass: rgba(0, 0, 53, 0.98);
        }
        body { margin: 0; padding: 0; font-family: 'Segoe UI', Roboto, sans-serif; color: var(--text); background: var(--white); }
        
        /* --- NAVIGATION --- */
        .navbar { 
            display: flex; justify-content: center; align-items: center; 
            padding: 10px 5%; background: var(--navy); border-bottom: 3px solid var(--gold); 
            position: sticky; top: 0; z-index: 100; height: 70px; 
        }
        .nav-brand { color: var(--white); font-size: 1.1rem; font-weight: bold; letter-spacing: 1px; text-transform: uppercase; margin-left: 15px; }
        .logo-img { height: 50px; width: auto; border-radius: 50%; border: 2px solid var(--gold); }

        /* --- HERO --- */
        .hero { background: linear-gradient(135deg, var(--navy) 0%, #001f3f 100%); color: var(--white); padding: 80px 5%; text-align: center; }
        .hero h1 { font-size: 2.5rem; margin-bottom: 20px; text-transform: uppercase; letter-spacing: 2px; }
        
        /* --- CALCULATOR CARD --- */
        .calc-section { padding: 60px 5%; background: var(--grey); }
        .calc-container { 
            max-width: 600px; margin: auto; background: var(--white); 
            border-radius: 12px; box-shadow: 0 20px 50px rgba(0,0,0,0.15); 
            overflow: hidden; border-top: 5px solid var(--gold);
        }
        
        .calc-header { background: #111; color: #fff; padding: 25px; text-align: center; }
        .calc-body { padding: 30px; }

        /* Input Styling */
        .input-row { margin-bottom: 25px; }
        .input-label { display: flex; justify-content: space-between; font-weight: bold; font-size: 0.9rem; margin-bottom: 10px; color: #555; text-transform: uppercase; }
        .input-val-display { color: var(--navy); font-weight: bold; }
        
        .hybrid-input { display: flex; align-items: center; gap: 15px; }
        input[type="number"], input[type="text"], input[type="email"] { 
            padding: 12px; border: 1px solid #ccc; border-radius: 6px; font-size: 1rem; width: 100%; transition: 0.3s;
        }
        input[type="number"]:focus, input[type="text"]:focus, input[type="email"]:focus { border-color: var(--gold); outline: none; }
        
        /* Range Sliders */
        input[type=range] { flex-grow: 1; accent-color: var(--gold); cursor: pointer; height: 6px; }

        /* Results Display */
        .result-box { 
            background: var(--navy); color: #fff; padding: 20px; border-radius: 8px; 
            text-align: center; margin-bottom: 30px; position: relative; overflow: hidden;
        }
        .result-title { font-size: 0.8rem; letter-spacing: 1px; opacity: 0.8; margin-bottom: 5px; }
        .result-amt { font-size: 2.5rem; color: var(--gold); font-weight: bold; }
        .result-note { font-size: 0.75rem; opacity: 0.6; margin-top: 5px; }
        
        /* Capture Form (The "Soft" Gate) */
        .capture-form { 
            border-top: 1px dashed #ccc; padding-top: 25px; animation: fadeIn 1s; 
        }
        .form-title { font-size: 0.9rem; font-weight: bold; margin-bottom: 15px; color: var(--navy); text-align: center; }
        
        .btn-submit { 
            background: var(--gold); color: var(--navy); width: 100%; padding: 15px; 
            border: none; border-radius: 6px; font-weight: bold; font-size: 1rem; 
            cursor: pointer; margin-top: 15px; transition: 0.3s; 
        }
        .btn-submit:hover { background: #bfa030; }

        /* Success State */
        #success-message { display: none; text-align: center; padding: 20px; background: #e8f5e9; border-radius: 6px; margin-top: 20px; }
        .success-link { display: block; margin-top: 10px; color: var(--emerald); font-weight: bold; text-decoration: none; border-bottom: 1px solid var(--emerald); display: inline-block;}

        @keyframes fadeIn { from {opacity:0;} to {opacity:1;} }
    </style>
</head>
<body>

<nav class="navbar">
    <div style="display:flex; align-items:center;">
        <img src="NDPS.Logo.jpg" alt="NDPS" class="logo-img">
        <span class="nav-brand">New Digital Payment Systems</span>
    </div>
</nav>

<section class="hero">
    <h1>The Infrastructure Audit</h1>
    <p>See exactly how much revenue you are losing to "Legacy" processing fees.</p>
</section>

<section class="calc-section">
    <div class="calc-container">
        <div class="calc-header">
            <h3 style="margin:0;">Live Margin Simulator</h3>
        </div>
        
        <div class="calc-body">
            
            <div class="input-row">
                <div class="input-label">
                    <span>Monthly Credit Card Volume</span>
                    <span class="input-val-display" id="disp-vol">$25,000</span>
                </div>
                <div class="hybrid-input">
                    <input type="number" id="vol-input" value="25000" step="1000" style="width: 100px;">
                    <input type="range" id="vol-range" min="5000" max="150000" step="1000" value="25000">
                </div>
            </div>

            <div class="input-row">
                <div class="input-label">
                    <span>Your Current Processing Rate</span>
                    <span class="input-val-display" id="disp-rate">3.5%</span>
                </div>
                <div class="hybrid-input">
                    <span style="font-size:0.8rem; color:#888;">Low (2%)</span>
                    <input type="range" id="rate-range" min="2.0" max="5.0" step="0.1" value="3.5">
                    <span style="font-size:0.8rem; color:#888;">High (5%)</span>
                </div>
                <div style="font-size: 0.8rem; color: #666; margin-top: 5px; font-style: italic;">
                    Move slider to match your current statement fees.
                </div>
            </div>

            <div class="result-box">
                <div class="result-title">ANNUAL PROFIT RECLAIMABLE</div>
                <div class="result-amt" id="savings-amt">$2,400</div>
                <div class="result-note">*Calculated against NDPS Wholesale Rate (2.7%)</div>
            </div>

            <form id="lead-form" action="https://formspree.io/f/maqonago" method="POST" class="capture-form">
           
                
                <input type="hidden" name="Selected_Volume" id="hidden-vol">
                <input type="hidden" name="Selected_Current_Rate" id="hidden-rate">
                <input type="hidden" name="Calculated_Annual_Savings" id="hidden-savings">

                <div class="form-title">GENERATE OFFICIAL BREAKDOWN</div>
        
                <input type="hidden" name="Selected_Volume" id="hidden-vol">
                <input type="hidden" name="Selected_Current_Rate" id="hidden-rate">
                <input type="hidden" name="Calculated_Annual_Savings" id="hidden-savings">

                <div class="form-title">GENERATE OFFICIAL BREAKDOWN</div>
                <p style="font-size:0.85rem; color:#666; margin-bottom:15px; text-align:center;">
                    To lock in this 2.7% rate and generate a formal PDF quote, please complete your profile.
                </p>

                <div style="margin-bottom: 15px;">
                    <input type="text" name="Business_Industry" id="biz-type" placeholder="Business Industry (e.g., Liquor Store, Cafe, Salon)">
                </div>

                <div style="margin-bottom: 15px;">
                    <input type="text" name="Business_Name" id="biz-name" placeholder="Business Legal Name">
                </div>

                <div style="display:grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <input type="text" name="Owner_Name" id="owner-name" placeholder="Owner Name">
                    <input type="email" name="email" id="owner-email" placeholder="Email Address" required>
                </div>

                <button type="submit" class="btn-submit" id="submit-btn">Send Me The Official Offer</button>

            </form>

            <div id="success-message">
                <strong>âœ“ Profile Captured</strong><br>
                <span style="font-size:0.9rem; color:#555;">An official proposal has been queued for you.</span>
                <br><br>
                <div id="dynamic-link-container"></div>
            </div>

        </div>
    </div>
</section>

<script>
    // --- SYNC & CALCULATOR LOGIC ---
    const volInput = document.getElementById('vol-input');
    const volRange = document.getElementById('vol-range');
    const rateRange = document.getElementById('rate-range');
    
    // Display Elements
    const dispVol = document.getElementById('disp-vol');
    const dispRate = document.getElementById('disp-rate');
    const savingsDisplay = document.getElementById('savings-amt');

    // Hidden Form Fields (For Data Capture)
    const hiddenVol = document.getElementById('hidden-vol');
    const hiddenRate = document.getElementById('hidden-rate');
    const hiddenSavings = document.getElementById('hidden-savings');

    // NDPS Fixed Offer
    const NDPS_RATE = 2.7; 

    // Sync Volume Inputs
    volInput.addEventListener('input', () => {
        volRange.value = volInput.value;
        updateCalc();
    });
    volRange.addEventListener('input', () => {
        volInput.value = volRange.value;
        updateCalc();
    });

    // Sync Rate Input
    rateRange.addEventListener('input', () => {
        updateCalc();
    });

    function updateCalc() {
        // Update Displays
        const vol = parseFloat(volInput.value) || 0;
        const currentRate = parseFloat(rateRange.value) || 0;

        dispVol.innerText = '$' + vol.toLocaleString();
        dispRate.innerText = currentRate.toFixed(1) + '%';

        // Math: (Volume * (Current - NDPS) / 100) * 12 Months
        const margin = currentRate - NDPS_RATE;
        
        // Don't show negative savings
        let monthlySavings = 0;
        if (margin > 0) {
            monthlySavings = vol * (margin / 100);
        }
        const annualSavings = monthlySavings * 12;
        const formattedSavings = '$' + annualSavings.toLocaleString(undefined, {minimumFractionDigits: 0, maximumFractionDigits: 0});

        savingsDisplay.innerText = formattedSavings;

        // UPDATE HIDDEN FIELDS FOR EMAIL CAPTURE
        hiddenVol.value = '$' + vol.toLocaleString();
        hiddenRate.value = currentRate.toFixed(1) + '%';
        hiddenSavings.value = formattedSavings;
    }

    // --- FORM HANDLING (AJAX to Formspree) ---
    var form = document.getElementById("lead-form");
    
    async function handleSubmit(event) {
        event.preventDefault(); // Stop standard redirect
        
        var status = document.getElementById("success-message");
        var btn = document.getElementById("submit-btn");
        var bizType = document.getElementById("biz-type").value.toLowerCase();
        
        var data = new FormData(event.target);
        
        btn.innerText = "Sending Data...";
        btn.style.opacity = "0.7";

        fetch(event.target.action, {
            method: form.method,
            body: data,
            headers: {
                'Accept': 'application/json'
            }
        }).then(response => {
            if (response.ok) {
                // SUCCESS STATE
                form.style.display = "none";
                status.style.display = "block";
                
                // INTELLIGENT REDIRECT LOGIC
                const linkContainer = document.getElementById('dynamic-link-container');
                let suggestedLink = "";

                if (bizType.includes("liquor") || bizType.includes("wine") || bizType.includes("bar")) {
                    suggestedLink = '<a href="Hops.Grapes.html" class="success-link">View Case Study: High Volume Liquor Retail</a>';
                } else if (bizType.includes("game") || bizType.includes("comic") || bizType.includes("hobby")) {
                    suggestedLink = '<a href="Watcher.Comix.html" class="success-link">View Case Study: Collectibles & Risk</a>';
                } else {
                    suggestedLink = '<a href="#" class="success-link">Download General Retail Audit (PDF)</a>';
                }
                linkContainer.innerHTML = suggestedLink;

            } else {
                response.json().then(data => {
                    if (Object.hasOwn(data, 'errors')) {
                        alert(data["errors"].map(error => error["message"]).join(", "));
                    } else {
                        alert("Oops! There was a problem submitting your form");
                    }
                    btn.innerText = "Try Again";
                    btn.style.opacity = "1";
                })
            }
        }).catch(error => {
            alert("Oops! There was a problem submitting your form");
            btn.innerText = "Try Again";
            btn.style.opacity = "1";
        });
    }
    form.addEventListener("submit", handleSubmit);

    // Init
    updateCalc();

</script>

</body>
</html>
